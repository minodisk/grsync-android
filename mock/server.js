var path = require('path')
var express = require('express')

function main() {
  var e = express()
  e.get('/v1/ping', ping)
  e.get('/v1/device', device)
  e.get('/_gr', _gr)
  e.get('/_gr/objs', objs)
  e.get('/v1/photos/:dir/:file', photos)
  e.listen(80)
}

//http://192.168.0.1/v1/ping
function ping(req, res) {
  res.json({
    "errCode" : 200,
    "errMsg" : "OK",
    "datetime" : "2017-05-25T11:34:36"
  })
}

//http://192.168.0.1/v1/constants/device
function device(req, res) {
  res.json({
    "errCode" : 200,
    "errMsg" : "OK",
    "model" : "GR II",
    "firmwareVersion" : "01.10",
    "macAddress" : "ac:3f:a4:64:fd:48",
    "serialNo" : "00100880",
    "channelList" : [0,1,2,3,4,5,6,7,8,9,10,11]
  })
}

//http://192.168.0.1/_gr
function _gr(req, res) {
  console.log(req)
// mpget=LENS_LOCK AF_LEVER
`{
"errCode" : 200,
"errMsg" : "OK",
"id" : "LENS_LOCK AF_LEVER",
"LENS_LOCK" : 0,
"AF_LEVER" : 0,
"retCode" : 0
}`

//pset=LENS_LOCK 0
`{
"errCode" : 200,
"errMsg" : "OK",
"id" : "LENS_LOCK",
"retCode" : 0
}`

//cmd=acclock off
`{"errCode": 400,"errMsg": "Bad Request"}`

// cmd=bafl
`{
"errCode" : 200,
"errMsg" : "OK",
"cmd" : "bafl",
"retCode" : 0,
"retStr" : ""
}`
}

//http://192.168.0.1/_gr/objs
function objs(req, res) {
  res.json({
    "errCode": 200,
    "errMsg": "OK",
    "dirs":  [
      {
        "name":"107_0310",
        "files":[
          {"n":"GR001276.JPG","o":1,"s":"LF","d":"2017-03-10T13:24:54"},
          {"n":"GR001276.DNG","o":1,"s":"LF","d":"2017-03-10T13:24:54"},
          {"n":"GR001277.JPG","o":1,"s":"LF","d":"2017-03-10T13:27:43"},
          {"n":"GR001277.DNG","o":1,"s":"LF","d":"2017-03-10T13:27:43"},
          {"n":"GR001278.JPG","o":1,"s":"LF","d":"2017-03-10T13:27:49"},
          {"n":"GR001278.DNG","o":1,"s":"LF","d":"2017-03-10T13:27:49"},
          {"n":"GR001279.JPG","o":1,"s":"LF","d":"2017-03-10T13:28:04"},
          {"n":"GR001279.DNG","o":1,"s":"LF","d":"2017-03-10T13:28:04"},
          {"n":"GR001280.JPG","o":1,"s":"LF","d":"2017-03-10T13:28:28"},
          {"n":"GR001280.DNG","o":1,"s":"LF","d":"2017-03-10T13:28:28"},
          {"n":"GR001281.JPG","o":1,"s":"LF","d":"2017-03-10T13:31:59"},
          {"n":"GR001281.DNG","o":1,"s":"LF","d":"2017-03-10T13:31:59"},
          {"n":"GR001282.JPG","o":1,"s":"LF","d":"2017-03-10T13:32:01"},
          {"n":"GR001282.DNG","o":1,"s":"LF","d":"2017-03-10T13:32:01"},
          {"n":"GR001283.JPG","o":1,"s":"LF","d":"2017-03-10T16:36:57"},
          {"n":"GR001283.DNG","o":1,"s":"LF","d":"2017-03-10T16:36:57"},
          {"n":"GR001284.JPG","o":1,"s":"LF","d":"2017-03-10T16:37:06"},
          {"n":"GR001284.DNG","o":1,"s":"LF","d":"2017-03-10T16:37:06"}
        ]
      },
      {
        "name":"108_0311",
        "files":[
          {"n":"GR001285.JPG","o":1,"s":"LF","d":"2017-03-11T10:58:00"},
          {"n":"GR001285.DNG","o":1,"s":"LF","d":"2017-03-11T10:58:00"},
          {"n":"GR001286.JPG","o":1,"s":"LF","d":"2017-03-11T10:58:02"},
          {"n":"GR001286.DNG","o":1,"s":"LF","d":"2017-03-11T10:58:02"},
          {"n":"GR001287.JPG","o":1,"s":"LF","d":"2017-03-11T10:58:03"},
          {"n":"GR001287.DNG","o":1,"s":"LF","d":"2017-03-11T10:58:03"},
          {"n":"GR001288.JPG","o":1,"s":"LF","d":"2017-03-11T10:58:06"},
          {"n":"GR001288.DNG","o":1,"s":"LF","d":"2017-03-11T10:58:06"},
          {"n":"GR001289.JPG","o":1,"s":"LF","d":"2017-03-11T10:58:54"},
          {"n":"GR001289.DNG","o":1,"s":"LF","d":"2017-03-11T10:58:54"},
          {"n":"GR001290.JPG","o":1,"s":"LF","d":"2017-03-11T11:00:42"},
          {"n":"GR001290.DNG","o":1,"s":"LF","d":"2017-03-11T11:00:42"},
          {"n":"GR001291.JPG","o":1,"s":"LF","d":"2017-03-11T11:30:17"},
          {"n":"GR001291.DNG","o":1,"s":"LF","d":"2017-03-11T11:30:17"},
          {"n":"GR001292.JPG","o":1,"s":"LF","d":"2017-03-11T11:30:25"},
          {"n":"GR001292.DNG","o":1,"s":"LF","d":"2017-03-11T11:30:25"},
          {"n":"GR001293.JPG","o":1,"s":"LF","d":"2017-03-11T11:30:47"},
          {"n":"GR001293.DNG","o":1,"s":"LF","d":"2017-03-11T11:30:47"},
          {"n":"GR001294.JPG","o":1,"s":"LF","d":"2017-03-11T11:31:13"},
          {"n":"GR001294.DNG","o":1,"s":"LF","d":"2017-03-11T11:31:13"},
          {"n":"GR001295.JPG","o":1,"s":"LF","d":"2017-03-11T11:31:13"},
          {"n":"GR001295.DNG","o":1,"s":"LF","d":"2017-03-11T11:31:13"},
          {"n":"GR001296.JPG","o":1,"s":"LF","d":"2017-03-11T11:32:56"},
          {"n":"GR001296.DNG","o":1,"s":"LF","d":"2017-03-11T11:32:56"},
          {"n":"GR001297.JPG","o":1,"s":"LF","d":"2017-03-11T11:33:50"},
          {"n":"GR001297.DNG","o":1,"s":"LF","d":"2017-03-11T11:33:50"},
          {"n":"GR001298.JPG","o":1,"s":"LF","d":"2017-03-11T11:34:20"},
          {"n":"GR001298.DNG","o":1,"s":"LF","d":"2017-03-11T11:34:20"},
          {"n":"GR001299.JPG","o":1,"s":"LF","d":"2017-03-11T11:34:33"},
          {"n":"GR001299.DNG","o":1,"s":"LF","d":"2017-03-11T11:34:33"},
          {"n":"GR001300.JPG","o":1,"s":"LF","d":"2017-03-11T11:40:21"},
          {"n":"GR001300.DNG","o":1,"s":"LF","d":"2017-03-11T11:40:21"},
          {"n":"GR001301.JPG","o":1,"s":"LF","d":"2017-03-11T13:08:56"},
          {"n":"GR001301.DNG","o":1,"s":"LF","d":"2017-03-11T13:08:56"},
          {"n":"GR001302.JPG","o":1,"s":"LF","d":"2017-03-11T13:08:57"},
          {"n":"GR001302.DNG","o":1,"s":"LF","d":"2017-03-11T13:08:57"},
          {"n":"GR001303.JPG","o":1,"s":"LF","d":"2017-03-11T13:09:00"},
          {"n":"GR001303.DNG","o":1,"s":"LF","d":"2017-03-11T13:09:00"},
          {"n":"GR001304.JPG","o":1,"s":"LF","d":"2017-03-11T13:19:39"},
          {"n":"GR001304.DNG","o":1,"s":"LF","d":"2017-03-11T13:19:39"},
          {"n":"GR001305.JPG","o":1,"s":"LF","d":"2017-03-11T13:26:39"},
          {"n":"GR001305.DNG","o":1,"s":"LF","d":"2017-03-11T13:26:39"},
          {"n":"GR001306.JPG","o":1,"s":"LF","d":"2017-03-11T13:28:15"},
          {"n":"GR001306.DNG","o":1,"s":"LF","d":"2017-03-11T13:28:15"},
          {"n":"GR001307.JPG","o":1,"s":"LF","d":"2017-03-11T13:28:16"},
          {"n":"GR001307.DNG","o":1,"s":"LF","d":"2017-03-11T13:28:16"},
          {"n":"GR001308.JPG","o":1,"s":"LF","d":"2017-03-11T13:28:20"},
          {"n":"GR001308.DNG","o":1,"s":"LF","d":"2017-03-11T13:28:20"},
          {"n":"GR001309.JPG","o":1,"s":"LF","d":"2017-03-11T13:31:49"},
          {"n":"GR001309.DNG","o":1,"s":"LF","d":"2017-03-11T13:31:49"},
          {"n":"GR001310.JPG","o":1,"s":"LF","d":"2017-03-11T13:31:54"},
          {"n":"GR001310.DNG","o":1,"s":"LF","d":"2017-03-11T13:31:54"},
          {"n":"GR001311.JPG","o":1,"s":"LF","d":"2017-03-11T13:36:39"},
          {"n":"GR001311.DNG","o":1,"s":"LF","d":"2017-03-11T13:36:39"},
          {"n":"GR001312.JPG","o":1,"s":"LF","d":"2017-03-11T13:36:42"},
          {"n":"GR001312.DNG","o":1,"s":"LF","d":"2017-03-11T13:36:42"},
          {"n":"GR001313.JPG","o":1,"s":"LF","d":"2017-03-11T13:36:44"},
          {"n":"GR001313.DNG","o":1,"s":"LF","d":"2017-03-11T13:36:44"},
          {"n":"GR001314.JPG","o":1,"s":"LF","d":"2017-03-11T13:36:47"},
          {"n":"GR001314.DNG","o":1,"s":"LF","d":"2017-03-11T13:36:47"},
          {"n":"GR001315.JPG","o":1,"s":"LF","d":"2017-03-11T13:36:51"},
          {"n":"GR001315.DNG","o":1,"s":"LF","d":"2017-03-11T13:36:51"},
          {"n":"GR001316.JPG","o":1,"s":"LF","d":"2017-03-11T13:36:52"},
          {"n":"GR001316.DNG","o":1,"s":"LF","d":"2017-03-11T13:36:52"},
          {"n":"GR001317.JPG","o":1,"s":"LF","d":"2017-03-11T13:36:53"},
          {"n":"GR001317.DNG","o":1,"s":"LF","d":"2017-03-11T13:36:53"},
          {"n":"GR001318.JPG","o":1,"s":"LF","d":"2017-03-11T13:36:53"},
          {"n":"GR001318.DNG","o":1,"s":"LF","d":"2017-03-11T13:36:53"},
          {"n":"GR001319.JPG","o":1,"s":"LF","d":"2017-03-11T13:36:54"},
          {"n":"GR001319.DNG","o":1,"s":"LF","d":"2017-03-11T13:36:54"},
          {"n":"GR001320.JPG","o":1,"s":"LF","d":"2017-03-11T13:39:08"},
          {"n":"GR001320.DNG","o":1,"s":"LF","d":"2017-03-11T13:39:08"},
          {"n":"GR001321.JPG","o":1,"s":"LF","d":"2017-03-11T13:39:10"},
          {"n":"GR001321.DNG","o":1,"s":"LF","d":"2017-03-11T13:39:10"},
          {"n":"GR001322.JPG","o":1,"s":"LF","d":"2017-03-11T13:39:12"},
          {"n":"GR001322.DNG","o":1,"s":"LF","d":"2017-03-11T13:39:12"},
          {"n":"GR001323.JPG","o":1,"s":"LF","d":"2017-03-11T13:39:24"},
          {"n":"GR001323.DNG","o":1,"s":"LF","d":"2017-03-11T13:39:24"},
          {"n":"GR001324.JPG","o":1,"s":"LF","d":"2017-03-11T14:01:45"},
          {"n":"GR001324.DNG","o":1,"s":"LF","d":"2017-03-11T14:01:45"},
          {"n":"GR001325.JPG","o":1,"s":"LF","d":"2017-03-11T14:01:46"},
          {"n":"GR001325.DNG","o":1,"s":"LF","d":"2017-03-11T14:01:46"},
          {"n":"GR001326.JPG","o":1,"s":"LF","d":"2017-03-11T14:01:47"},
          {"n":"GR001326.DNG","o":1,"s":"LF","d":"2017-03-11T14:01:47"},
          {"n":"GR001327.JPG","o":1,"s":"LF","d":"2017-03-11T14:01:48"},
          {"n":"GR001327.DNG","o":1,"s":"LF","d":"2017-03-11T14:01:48"},
          {"n":"GR001328.JPG","o":1,"s":"LF","d":"2017-03-11T14:01:50"},
          {"n":"GR001328.DNG","o":1,"s":"LF","d":"2017-03-11T14:01:50"},
          {"n":"GR001329.JPG","o":1,"s":"LF","d":"2017-03-11T14:01:51"},
          {"n":"GR001329.DNG","o":1,"s":"LF","d":"2017-03-11T14:01:51"}
        ]
      },
      {
        "name":"109_0331",
        "files":[
          {"n":"GR001330.JPG","o":1,"s":"LF","d":"2017-03-31T00:54:30"},
          {"n":"GR001330.DNG","o":1,"s":"LF","d":"2017-03-31T00:54:30"},
          {"n":"GR001331.JPG","o":1,"s":"LF","d":"2017-03-31T00:54:50"},
          {"n":"GR001331.DNG","o":1,"s":"LF","d":"2017-03-31T00:54:50"},
          {"n":"GR001332.JPG","o":1,"s":"LF","d":"2017-03-31T07:58:01"},
          {"n":"GR001332.DNG","o":1,"s":"LF","d":"2017-03-31T07:58:01"},
          {"n":"GR001333.JPG","o":1,"s":"LF","d":"2017-03-31T07:58:37"},
          {"n":"GR001333.DNG","o":1,"s":"LF","d":"2017-03-31T07:58:37"},
          {"n":"GR001334.JPG","o":1,"s":"LF","d":"2017-03-31T07:58:42"},
          {"n":"GR001334.DNG","o":1,"s":"LF","d":"2017-03-31T07:58:42"},
          {"n":"GR001335.JPG","o":1,"s":"LF","d":"2017-03-31T07:58:45"},
          {"n":"GR001335.DNG","o":1,"s":"LF","d":"2017-03-31T07:58:45"},
          {"n":"GR001336.JPG","o":1,"s":"LF","d":"2017-03-31T07:58:49"},
          {"n":"GR001336.DNG","o":1,"s":"LF","d":"2017-03-31T07:58:49"},
          {"n":"GR001337.JPG","o":1,"s":"LF","d":"2017-03-31T07:59:03"},
          {"n":"GR001337.DNG","o":1,"s":"LF","d":"2017-03-31T07:59:03"}
        ]
      }
    ]
  })
}

//http://192.168.0.1/v1/photos/107_0310/GR001284.JPG?size=thumb
//http://192.168.0.1/v1/photos/107_0310/GR001276.JPG?size=view
function photos(req, res) {
  switch (req.query.size) {
    default:
      res.sendFile(path.resolve('./fixtures/raw/GR001276.JPG'))
      break;
    case 'thumb':
      res.sendFile(path.resolve('./fixtures/thumb/GR001276.jpg'))
      break;
    case 'view':
      res.sendFile(path.resolve('./fixtures/view/GR001276.jpg'))
      break;
  }
}

main()
